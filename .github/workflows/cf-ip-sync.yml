      - name: Setup WARP
        run: |
          wgcf register --accept-tos
          wgcf generate

          PRIVATE_KEY=$(grep PrivateKey wgcf-profile.conf | head -n1 | awk '{print $3}')
          PUBLIC_KEY=$(grep PublicKey wgcf-profile.conf | head -n1 | awk '{print $3}')

          # 用 base64 写入 warp.conf，避免 YAML 解析 [Interface] 报错
          cat > warp.conf.b64 <<'EOF'
W0ludGVyZmFjZV0KUFJJVkFURV9LRVkKQWRkcmVzcyA9IDE3Mi4xNi4wLjIvMzIKCltQZWVyXQpQVUJMSUNfS0VZCkFsbG93ZWRJcHMgPSAwLjAuMC4wLzAKRW5kcG9pbnQgPSBlbmdhZ2UuY2xvdWRmbGFyZWNsaWVudC5jb206MjQwOAoKW1NvY2tzNV0KQmluZEFkZHJlc3MgPSAxMjcuMC4wLjE6NDAwMDAKEOF

          # 解码
          base64 -d warp.conf.b64 > warp.conf

          # 替换占位符
          sed -i "s/PRIVATE_KEY/$PRIVATE_KEY/" warp.conf
          sed -i "s/PUBLIC_KEY/$PUBLIC_KEY/" warp.conf

          # 启动 wireproxy
          nohup wireproxy -c warp.conf >/dev/null 2>&1 &
          sleep 5
